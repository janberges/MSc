% !TEX root = ../thesis.tex

\chapter{\name{Eliashberg} theory}

Based on the results presented in the previous chapter, one can formulate a set
of equations, namely the \name{Eliashberg} equations, which determine
self-energies for both normal and anomalous \name{Green} functions, the latter
being suitable order parameters for the superconducting state.

To that end it is convenient to combine the \name{Green} functions of interest
into a $2 \times 2$ matrix, i.e. to use the \name{Nambu} formalism, which is
presented in the first section. With that, the general form of the
\name{Eliashberg} equations on the imaginary frequency axis are derived,
followed by some common simplifications which assume (i) a $\vec k$-independent
self-energy, (ii) a constant density of states and (iii) the suitability of a
\name{Coulomb} pseudo-potential. Next, it is shown how the results, which are
generally just the numerical values corresponding to a finite set of
\name{Matsubara} frequencies rather than analytical expressions, can be
continued to the real axis by means of \name{Pad√©} approximants. Finally, it is
outlined how \name{McMillan} and \name{Dynes}' formula for the critical
temperature can be obtained from the \name{Eliashberg} theory.

\section{\name{Nambu} formalism}

As found by \name{Nambu} \cite{Nambu60}, the \text{Dyson} equations for all four
electronic \name{Green} functions introduced at the beginning of
Section~\ref{Model interactions} can be compactly formulated as a single matrix
equation:
%
\begin{equation*}
    \input{tikzin/nambu-dyson.tex}
\end{equation*}
%
or formally, where quantum numbers and frequency arguments are suppressed,
%
\begin{equation} \label{Nambu-Dyson equation}
    \begin{split}
        \begin{bmatrix}
            G & F \\
            \widetilde F & \widetilde G
        \end{bmatrix}
        &=
        \begin{bmatrix}
            G_0 & 0 \\
            0 & \widetilde G_0
        \end{bmatrix}
        +
        \begin{bmatrix}
            G_0 & 0 \\
            0 & \widetilde G_0
        \end{bmatrix}
        \begin{bmatrix}
            \Sigma^G & \Sigma^F \\
            \Sigma^{\widetilde F} & \Sigma^{\widetilde G}
        \end{bmatrix}
        \begin{bmatrix}
            G & F \\
            \widetilde F & \widetilde G
        \end{bmatrix}
        \\
        &=
        \begin{bmatrix*}[r]
            G_0 + G_0 \Sigma^G G + G_0 \Sigma^F \widetilde F
            & G_0 \Sigma^G F + G_0 \Sigma^F \widetilde G \\
            \widetilde G_0 \Sigma^{\widetilde F} G
            + \widetilde G_0 \Sigma^{\widetilde G} \widetilde F
            & \widetilde G_0 + \widetilde G_0 \Sigma^{\widetilde F} F
            + \widetilde G_0 \Sigma^{\widetilde G} \widetilde G
        \end{bmatrix*}
        \\
        &\approx
        \begin{bmatrix*}[r]
            G_0 + G_0 \Sigma^G_0 G_0 & G_0 \Sigma^F_0 \widetilde G_0 \\
            \widetilde G_0 \Sigma^{\widetilde F}_0 G_0 & \widetilde G_0
            + \widetilde G_0 \Sigma^{\widetilde G}_0 \widetilde G_0
        \end{bmatrix*}.
    \end{split}
\end{equation}

\tikz [baseline=-0.5ex] \draw [ inward] (0, 0) -- (0.5, 0); and
\tikz [baseline=-0.5ex] \draw [outward] (0, 0) -- (0.5, 0);
%
vanish, so does each term of the perturbation series of
%
\tikz [baseline=-0.5ex] \draw [ inward, double] (0, 0) -- (0.5, 0); and
\tikz [baseline=-0.5ex] \draw [outward, double] (0, 0) -- (0.5, 0);.
%
A non-zero self-consistent solution of the above integral equations may still
exist \cite[before Eq.~2.14]{Nambu60}.

Giving names to the involved matrices, the \name{Dyson} equation may be written
as $\vec G = \vec G_0 + \vec G_0 \vec \Sigma \vec G$ or even $\vec G^{-1} = \vec
G_0^{-1} - \vec \Sigma$, using inverse matrices. With the help of the
two-component operators
%
\begin{equation*}
    \vec \uppsi_{\vec k} =
    \begin{bmatrix}
        \op c_{\vec k \uparrow} \\
        \op c_{-\vec k \downarrow}^+
    \end{bmatrix}
    \quad \text{and} \quad
    \vec \uppsi_{\vec k}^+ =
    \begin{bmatrix}
        \op a_{\vec k \uparrow}^+ &
        \op a_{-\vec k \downarrow},
    \end{bmatrix}
\end{equation*}
%
the dressed (bare) \name{Green} function matrix is concisely defined as
%
\begin{equation*}
    \vec G_{\vec k}^{(0)}(\I \omega_n) = -\int \from 0 \till \beta \D \tau \,
    \E^{\I \omega_n \tau} \av{ \op U \,
    \vec \uppsi_{\vec k}(\tau) \,
    \vec \uppsi_{\vec k}^+(0)}_{(0)},
\end{equation*}
%
where $\op U = 1 + \op P + \op P^+$ ensures terms conserving the particle number
in all components \cite{ScalapinoSchriefferWilkins66}.

Introducing unit and \name{Pauli} matrices
%
\begin{equation*}
    \vec \sigma_0 =
    \begin{bmatrix}
        1 & 0 \\
        0 & 1
    \end{bmatrix},
    \quad
    \vec \sigma_1 =
    \begin{bmatrix}
        0 & 1 \\
        1 & 0
    \end{bmatrix},
    \quad
    \vec \sigma_2 =
    \begin{bmatrix}
        0 & -\I \\
        \I & 0
    \end{bmatrix},
    \quad
    \vec \sigma_3 =
    \begin{bmatrix}
    1 & 0 \\
    0 & -1
    \end{bmatrix}
\end{equation*}
%
and the real scalar functions $Z_{\vec k}(\I \omega_n)$, $\phi^{(\prime)}_{\vec
k}(\I \omega_n)$ and $\chi_{\vec k}(\I \omega_n)$, the self-energy matrix is
written as
%
\begin{align} \label{self-energy matrix}
    \vec \Sigma_{\vec k}(\I \omega_n) &= \I \omega_n
    [1 - Z_{\vec k}(\I \omega_n)] \vec \sigma_0
    + \phi _{\vec k}(\I \omega_n) \vec \sigma_1
    + \phi'_{\vec k}(\I \omega_n) \vec \sigma_2
    + \chi _{\vec k}(\I \omega_n) \vec \sigma_3
    \\ \notag
    &=
    \begin{bmatrix}
        \I \omega_n [1 - Z_{\vec k}(\I \omega_n)] + \chi_{\vec k}(\I \omega_n) &
        \phi_{\vec k}(\I \omega_n) - \I \phi'_{\vec k}(\I \omega_n) \\
        \phi_{\vec k}(\I \omega_n) + \I \phi'_{\vec k}(\I \omega_n) &
        \I \omega_n [1 - Z_{\vec k}(\I \omega_n)] - \chi_{\vec k}(\I \omega_n)
    \end{bmatrix},
\end{align}
%
With $[\vec G^0_{\vec k}(\I \omega_n)]^{-1} = \I \omega_n \vec \sigma_0 -
\epsilon_{\vec k} \vec \sigma_3$ the \textsc{Dyson} equation reads
%
\begin{align*}
    \vec G_{\vec k}^{-1}(\I \omega_n) &=
    [\vec G^0_{\vec k}(\I \omega_n)]^{-1} - \vec \Sigma_{\vec k}(\I \omega_n)
    \\
    &= \I \omega_n Z_{\vec k}(\I \omega_n) \vec \sigma_0
    - \phi _{\vec k}(\I \omega_n) \vec \sigma_1
    - \phi'_{\vec k}(\I \omega_n) \vec \sigma_2
    - [\epsilon_{\vec k} + \chi_{\vec k}(\I \omega_n)] \vec \sigma_3 \\
    &= \begin{bmatrix}
        \I \omega_n Z_{\vec k}(\I \omega_n)
        - \epsilon_{\vec k} - \chi_{\vec k}(\I \omega_n) &
        -\phi_{\vec k}(\I \omega_n) + \I \phi'_{\vec k}(\I \omega_n) \\
        -\phi_{\vec k}(\I \omega_n) - \I \phi'_{\vec k}(\I \omega_n) &
        \I \omega_n Z_{\vec k}(\I \omega_n)
        + \epsilon_{\vec k} + \chi_{\vec k}(\I \omega_n)
    \end{bmatrix},
\end{align*}
%
Inversion yields
%
\begin{align*}
    \vec G_{\vec k}(\I \omega_n) &= -\Theta_{\vec k}^{-1}(\I \omega_n) \{
        \I \omega_n Z_{\vec k}(\I \omega_n) \vec \sigma_0
        + \phi _{\vec k}(\I \omega_n) \vec \sigma_1
        + \phi'_{\vec k}(\I \omega_n) \vec \sigma_2
        + [\epsilon_{\vec k} + \chi_{\vec k}(\I \omega_n)] \vec \sigma_3 \}
    \\
    &= -\frac 1 {\Theta_{\vec k}(\I \omega_n)}
    \begin{bmatrix}
        \I \omega_n Z_{\vec k}(\I \omega_n)
        + \epsilon_{\vec k} + \chi_{\vec k}(\I \omega_n) &
        \phi_{\vec k}(\I \omega_n) - \I \phi'_{\vec k}(\I \omega_n) \\
        \phi_{\vec k}(\I \omega_n) + \I \phi'_{\vec k}(\I \omega_n) &
        \I \omega_n Z_{\vec k}(\I \omega_n)
        - \epsilon_{\vec k} - \chi_{\vec k}(\I \omega_n)
    \end{bmatrix},
\end{align*}
%
where the denominator is given by
%
\begin{equation*}
    \Theta_{\vec k}(\I \omega_n) = -\det \vec G_{\vec k}^{-1}(\I \omega_n)
    = [\omega_n Z_{\vec k}(\I \omega_n)]^2
    + [\epsilon_{\vec k} + \chi_{\vec k}(\I \omega_n)]^2
    + \phi ^2_{\vec k}(\I \omega_n)
    + \phi'^2_{\vec k}(\I \omega_n).
\end{equation*}
%
The excitation energies are the poles of $\vec G_{\vec k}(\I \omega_n)$, i.e.
the zeros of $\Theta_{\vec k}(\I \omega_n)$, which satisfy
%
\begin{align*}
    (\I \omega_n)^2 = \left[ \frac
        {\epsilon_{\vec k} + \chi_{\vec k}(\I \omega_n)}
        {Z_{\vec k}(\I \omega_n)}
    \right]^2
    + \frac
        {\phi_{\vec k}^2(\I \omega_n) + \phi'^2_{\vec k}(\I \omega_n)}
        {Z_{\vec k}^2(\I \omega_n)}
    \equiv \widetilde \epsilon^2_{\vec k}(\I \omega_n)
    + |\Delta_{\vec k}(\I \omega)|^2.
\end{align*}
%
This identifies $Z_{\vec k}(\I \omega_n)$ as a renormalization function,
$\chi_{\vec k}(\I \omega_n)$ as an energy shift and $\phi^{(\prime)}_{\vec k}(\I
\omega_n)$ as a suitable order parameter, since the energy gap of the
superconducting state turns out to be
%
\begin{align*}
    \Delta_{\vec k}(\I \omega) = \frac
        {\phi_{\vec k}(\I \omega_n) - \I \phi'_{\vec k}(\I \omega_n)}
        {Z_{\vec k}(\I \omega_n)}.
\end{align*}

\newpage

\section{General equations}

A comparison with the results derived in Section~\ref{Hubbard model}
(\ref{Holstein model}) reveals that the approximation made in
Eq.~\ref{Nambu-Dyson equation} is correct up to the first (second) order of the
perturbation series for the \name{Hubbard} (\name{Holstein}) model.
Consequently, for the \emph{\name{Hubbard-Holstein} model} one has
%
\begin{equation*}
    \vec \Sigma_{\vec k} (\I \omega_n)
    = \vec \Sigma_{\vec k} \super{el.}
    + \vec \Sigma_{\vec k} \super{ph.} (\I \omega_n).
\end{equation*}

The electronic part within the HF approximation according to Eq.~\ref{HF
approximation} reads
%
\begin{align*}
    \vec \Sigma_{\vec k} \super{el.} (\I \omega_n)
    = \frac{U}{N \beta} &\sum_{\vec q m}
        \vec G_{\vec q} \super{od.} (\I \omega_m)
    \\
    = -\frac{U}{N \beta} &\sum_{\vec q m} \frac
        { \phi _{\vec q}(\I \omega_m) \vec \sigma_1
        + \phi'_{\vec q}(\I \omega_m) \vec \sigma_2 }
        {\Theta_{\vec q}(\I \omega_m)},
\end{align*}
%
where \q{od.} indicates that the components which are not \q{off-diagonal} have
been nullified.

The corresponding phononic part is
%
\begin{multline*}
    \vec \Sigma_{\vec k} \super{ph.} (\I \omega_n)
    = -\frac{g^2}{N \beta} \sum_{\vec q m}
    \vec \sigma_3 \, \vec G_{\vec q}(\I \omega_m) \, \vec \sigma_3 \,
    D^0_{\vec k - \vec q}(\I \omega_n - \I \omega_m),
    \\
    = \frac{g^2}{N \beta} \sum_{\vec q m}
    \frac { \I \omega_m
              Z_{\vec q}(\I \omega_m) \vec \sigma_0
        - \phi _{\vec q}(\I \omega_m) \vec \sigma_1
        - \phi'_{\vec q}(\I \omega_m) \vec \sigma_2
        + [\epsilon_{\vec q} + \chi_{\vec q}(\I \omega_m)] \vec \sigma_3 }
        {\Theta_{\vec q}(\I \omega_m)}
    D^0_{\vec k - \vec q}(\I \omega_n - \I \omega_m),
\end{multline*}
%
where the \name{Pauli} matrices in the first line swap the sign of the
off-diagonal components.

From now on, $T = \beta^{-1}$ is used rather than $\beta$. A coefficient
comparison with Eq.~\ref{self-energy matrix} yields the
\emph{\textsc{Eliashberg} equations} for the \name{Hubbard-Holstein} model:
%
\begin{subequations} \label{Eliashberg equations}
    \begin{align}
        \I \omega_n [1 - Z_{\vec k}(\I \omega_n)] &= \frac T N
        \sum_{\vec q m} \frac
            {\I \omega_m Z_{\vec q}(\I \omega_m)}
            {\Theta_{\vec q}(\I \omega_m)}
        g^2 D^0_{\vec k - \vec q}(\I \omega_n - \I \omega_m),
        \\
        \phi^{(\prime)}_{\vec k}(\I \omega_n) &= -\frac T N
        \sum_{\vec q m} \frac
            {\phi^{(\prime)}_{\vec q}(\I \omega_m)}
            {\Theta_{\vec q}(\I \omega_m)}
        \big[ g^2 D^0_{\vec k - \vec q}(\I \omega_n - \I \omega_m) + U \big],
        \\
        \chi_{\vec k}(\I \omega_n) &= \frac T N
        \sum_{\vec q m} \frac
            {\epsilon_{\vec q} + \chi_{\vec q}(\I \omega_m)}
            {\Theta_{\vec q}(\I \omega_m)}
        g^2 D^0_{\vec k - \vec q}(\I \omega_n - \I \omega_m).
    \end{align}
\end{subequations}
%
$\phi_{\vec k}(\I \omega_n)$ and $\phi'_{\vec k}(\I \omega_n)$ obey equal
equations, leaving the phase of $\phi_{\vec k}(\I \omega) - \I \phi'_{\vec k}(\I
\omega_n)$ undetermined. This gauge invariance allows to assume $\phi'_{\vec
k}(\I \omega_n) = 0$ \cites[37]{AllenMitrovic82}[around Eq.~2.20]{Nambu60}.

Using the definitions \cite{MargineGiustino13}
%
\begin{align*}
    \mu = n(0) \, U,
        \quad
    \lambda_{\vec q}(\I \nu_n) = -n(0) \, g^2 D_{\vec q}^0(\I \nu_n),
        \quad
    n(\epsilon) = \frac{N(\epsilon)} N,
        \quad
    N(\epsilon) = \sum_{\vec k} \delta(\epsilon - \epsilon_{\vec k}),
\end{align*}
%
where $n(\epsilon)$ is the density of states per spin and unit cell, one can
equivalently write
%
\begin{multline*}
    \vec \Sigma_{\vec k} (\I \omega_n)
    = \frac T {N(0)} \sum_{\vec q m}
    \Theta_{\vec q}^{-1}(\I \omega_m) \big \{ \dots
        \\
        \dots \{
            - \I \omega_m Z_{\vec q}(\I \omega_m) \vec \sigma_0
            + \phi_{\vec q}(\I \omega_m) \vec \sigma_1
            - [\epsilon_{\vec q} + \chi_{\vec q}(\I \omega_m)] \vec \sigma_3
            \}
        \lambda_{\vec k - \vec q}(\I \omega_n - \I \omega_m)
        - \phi_{\vec q}(\I \omega_m) \vec \sigma_1 \mu
    \big \},
\end{multline*}
%
which yields a more common formulation of the \name{Eliashberg} equations:
%
\begin{subequations}
    \begin{align}
        Z_{\vec k}(\I \omega_n) &= 1 + \frac T {N(0)} \frac 1 {\omega_n}
        \sum_{\vec q m} \frac
            {\omega_m Z_{\vec q}(\I \omega_m)}
            {\Theta_{\vec q}(\I \omega_m)}
        \lambda_{\vec k - \vec q}(\I \omega_n - \I \omega_m),
        \\
        \phi_{\vec k}(\I \omega_n) &= \frac T {N(0)}
        \sum_{\vec q m} \frac
            {\phi_{\vec q}(\I \omega_m)}
            {\Theta_{\vec q}(\I \omega_m)}
        \big[ \lambda_{\vec k - \vec q}(\I \omega_n - \I \omega_m) - \mu \big],
        \\
        \chi_{\vec k}(\I \omega_n) &= -\frac T {N(0)}
        \sum_{\vec q m} \frac
            {\epsilon_{\vec q} + \chi_{\vec q}(\I \omega_m)}
            {\Theta_{\vec q}(\I \omega_m)}
        \lambda_{\vec k - \vec q}(\I \omega_n - \I \omega_m).
    \end{align}
\end{subequations}

\section{Local self-energy}

Assuming that the phonon part of the unperturbed \name{Hamilton} operator reads
%
\begin{equation*}
    \op H_0 \super{ph.}
    = \omega \sub E \sum_{\vec R} \op b_{\vec R}^+ \op b_{\vec R}
    = \omega \sub E \sum_{\vec q \vec q'} \frac 1 N \sum_{\vec R}
        \E^{\I (\vec q' - \vec q) \vec R} \op b_{\vec q'}^+ \op b_{\vec q}
    = \omega \sub E \sum_{\vec q} \op b_{\vec q}^+ \op b_{\vec q},
\end{equation*}
%
with a single Einstein frequency $\omega \sub E$, which is already renormalized,
one finds
%
\begin{align*}
    D_0(\I \nu_n) &= -\int \from 0 \till \infty \D \omega \,
        \frac{2 \omega \, B(\omega)}{\nu_n^2 + \omega^2}
    = -\frac{2 \omega \sub E}{\nu_n^2 + \omega^2 \sub E}
    \quad \text{with} \quad
    B(\omega) = \delta(\omega - \omega \sub E) - \delta(\omega + \omega \sub E),
    \\
    \lambda(\I \nu_n) &= \int \from 0 \till \infty \D \omega \,
        \frac{2 \omega \, \alpha^2 F(\omega)}{\nu_n^2 + \omega^2}
    = \frac{2 \omega \sub E \, n(0) \, g^2}{\nu_n^2 + \omega^2 \sub E}
    \quad \text{with} \quad
    \alpha^2 F(\omega) = n(0) \, g^2 B(\omega)
\end{align*}
%
independent of $\vec k$, i.e. \emph{local}. $B(\omega)$ and $\alpha^2 F(\omega)$
are \emph{phonon} and \emph{electron-phonon spectral functions}, respectively.
As a consequence, the same applies to the self-energy $\vec \Sigma$ and its
components $Z$, $\phi$ and $\chi$. It is thus possible to replace the $\vec q$
summation by an energy integral:
%
\begin{multline} \label{local self-energy}
    \vec \Sigma(\I \omega_n)
    = T \sum_m \int \from{-\infty} \till \infty \D \epsilon \,
    \frac{N(\epsilon)}{N(0)}
    \Theta_\epsilon^{-1}(\I \omega_m) \big \{ \dots
        \\
        \dots \{
            - \I \omega_m Z(\I \omega_m) \vec \sigma_0
            + \phi(\I \omega_m) \vec \sigma_1
            - [\epsilon + \chi(\I \omega_m)] \vec \sigma_3
            \}
        \lambda(\I \omega_n - \I \omega_m)
        - \phi(\I \omega_m) \vec \sigma_1 \mu
    \big \}
\end{multline}
%
with $\Theta_\epsilon(\I \omega_n) = [\omega_n Z(\I \omega_n)]^2 + \phi^2(\I
\omega_n) + [\epsilon + \chi(\I \omega_n)]^2$. The \emph{local \name{Eliashberg}
equations} read
%
\begin{subequations} \label{local Eliashberg equations}
   \begin{align}
      Z(\I \omega_n) &= 1 + \frac T {\omega_n} \sum_m
      \int \from{-\infty} \till \infty \D \epsilon \frac{N(\epsilon)}{N(0)}
      \frac{\omega_m Z (\I \omega_m)}{\Theta_\epsilon(\I \omega_m)}
      \lambda(\I \omega_n - \I \omega_m),
      \\
      \phi(\I \omega_n) &= T \sum_m
      \int \from{-\infty} \till \infty \D \epsilon \frac{N(\epsilon)}{N(0)}
      \frac{\phi(\I \omega_m)}{\Theta_\epsilon(\I \omega_m)}
      [\lambda(\I \omega_n - \I \omega_m) - \mu],
      \\
      \chi(\I \omega_n) &= -T \sum_m
      \int \from{-\infty} \till \infty \D \epsilon \frac{N(\epsilon)}{N(0)}
      \frac{\epsilon + \chi(\I \omega_m)}{\Theta_\epsilon(\I \omega_m)}
      \lambda(\I \omega_n - \I \omega_m).
   \end{align}
\end{subequations}

\subsection{Constant-DOS approximation}

Save for the factor $N(\epsilon)$, which is unspecified at this point, the
integrands in Eq.~\ref{local self-energy} converge towards zero as $\epsilon$
diverges from $-\chi(\I \omega_m)$. Therefore, assuming $\chi(\I \omega_m)
\approx 0$, it may be acceptable to approximate $N(\epsilon)$ by a constant
$N(0)$ so that the integration can be performed analytically. With the help of
%
\begin{equation} \label{integrals}
    \int_{-\infty}^\infty \frac{\D x}{x^2 + z} = \frac \pi {\sqrt z}
    \quad \text{and} \quad
    \mathcal P \int \from{-\infty} \till \infty \D x \, \frac x {x^2 + z} = 0,
\end{equation}
%
where $\mathcal P$ denotes the \textsc{Cauchy} principal value, and using
$\Delta(\I \omega) = \phi(\I \omega) / Z(\I \omega)$, this yields
%
\begin{equation*}
    \vec \Sigma(\I \omega_n)
    = \pi T \sum_m \frac{ \{
        - \I \omega_m \vec \sigma_0
        + \Delta(\I \omega_m) \vec \sigma_1 \}
        \lambda(\I \omega_n - \I \omega_m)
        - \Delta(\I \omega_m) \vec \sigma_1 \mu }
        { \sqrt{\omega_m^2 + \Delta^2(\I \omega_m)} }
\end{equation*}
%
and thus the \emph{constant-DOS \name{Eliashberg} equations}
%
\begin{subequations}
    \begin{align}
        Z(\I \omega_n) &= 1 + \frac{\pi T}{\omega_n} \sum_m
        \frac{\omega_m}{\sqrt{\omega_m^2 + \Delta^2(\I \omega_m)}}
        \lambda(\I \omega_n - \I \omega_m),
        \\
        \Delta(\I \omega_n) &= \frac{\pi T}{Z(\I \omega_n)} \sum_m
        \frac{\Delta(\I \omega_m)}{\sqrt{\omega_m^2 + \Delta^2(\I \omega_m)}}
        [\lambda(\I \omega_n - \I \omega_m) - \mu].
    \end{align}
\end{subequations}

The effect of this approximation is visualized in Fig.~\ref{constant-DOS
approximation}.

\begin{figure}
    \small
    \begin{subfigure}{6.75cm}
        \input{tikzin/const-dos-approx-1.tex}
        \caption{$\omega = 0.2\,\mathrm{eV}$. At higher frequencies, exact and
                 approximate integrand may differ considerably.}
    \end{subfigure}%
    \hfill%
    \begin{subfigure}{6.75cm}
        \input{tikzin/const-dos-approx-2.tex}
        \caption{$\omega = 0.02\,\mathrm{eV}$. At lower frequencies, points for
                 numerical integration must be chosen carefully.}
    \end{subfigure}
    \captionsetup{singlelinecheck=off}
    \caption[Constant-DOS approximation]{ %
        The constant-DOS approximation is exemplified by its application to the
        scalar product of the density of states $n(\epsilon)$ of a square
        tight-binding lattice (compare Section $n$) and a \name{Lorentz}
        function:
        %
        \begin{align*}
            \int \from{-\infty} \till \infty
            \D \epsilon \, \frac {n(\epsilon)} \pi
            \frac \omega {\omega^2 + \epsilon^2}
            \quad
            (\tikz \draw [fill=red!70!white, rounded corners=3pt]
                (0, 0) rectangle (0.5, 0.2);)
            \quad \approx \quad
            \int \from{-\infty} \till \infty
            \D \epsilon \, \frac {n(0)} \pi
            \frac \omega {\omega^2 + \epsilon^2}.
            \quad
            (\tikz \draw [fill=yellow!60!white, rounded corners=3pt]
                (0, 0) rectangle (0.5, 0.2);)
        \end{align*}
        %
        The exact integral bears a close resemblance to those which occur in the
        local self energy (Eq.~\ref{local self-energy}).
        }
    \label{constant-DOS approximation}
\end{figure}

\subsection{Critical point and normal state}

At $T \sub c$, where the order parameter $\Delta(\I \omega_m)$ is infinitesimal,
and in the normal state, where it is zero, it can be neglected relative to
$\omega_m$. This yields the \emph{linearized \name{Eliashberg} equations},
%
\begin{subequations} \label{linearized Eliashberg equations}
    \begin{align}
        Z(\I \omega_n) &= 1 + \frac{\pi T}{\omega_n} \sum_m
        \sgn(\omega_m) \, \lambda(\I \omega_n - \I \omega_m),
        \\
        \Delta(\I \omega_n) &= \frac{\pi T}{Z(\I \omega_n)} \sum_m
        \frac{\Delta(\I \omega_m)}{|\omega_m|}
        [\lambda(\I \omega_n - \I \omega_m) - \mu].
    \end{align}
\end{subequations}

At this point the equation for $Z(\I \omega_n)$ is neither coupled to the
equation of $\Delta(\I \omega)$ nor must it be solved self-consistently. One can
further evaluate
%
\begin{equation*}
    Z(\I \omega_n) = 1 + \frac{\pi T}{\omega_n} \sum_{m=-n}^n \lambda(\I \nu_m)
    = 1 + \frac{\pi T}{\omega_n}
    \Big[ \lambda(0) + 2 \sum_{m=1}^n \lambda(\I \nu_m) \Big].
\end{equation*}

\subsection{\name{Coulomb} pseudo-potential}

Solving the above equations on a computer requires a truncation of the infinite
sum over \textsc{Matsubara} frequencies. For the phonon part this is
unproblematic since it has a natural cutoff through $\lambda(\I \nu_n)$, which
decays rapidly with the magnitude of $\nu_n$. The \textsc{Coulomb} part,
however, does not depend on frequency and thus couples all terms equally strong.
As a consequence, any cutoff frustrates convergence to reasonable values. The
following procedure circumvents this difficulty.

Let $\phi(\I \omega_n) = \phi \sub{ph} (\I \omega_n) + \phi \sub C$ and consider
the \textsc{Eliashberg} equation for $\phi \sub C$,
%
\begin{align*}
	\phi \sub C = -\mu \pi T \sum_m^{\mathclap{|\omega_m| < \omega_u}}
    \frac
        {\phi(\I \omega_m)}
        {\sqrt{[\omega_m Z(\I \omega_m)]^2 + \phi^2(\I \omega_m)}},
\end{align*}
%
where $\omega_u$ is the (upper) cutoff frequency. The idea is to truncate the
Coulomb part at a lower frequency $\omega_l$, above which the phonon part $\phi
\sub{ph} (\I \omega_m)$ is already negligible and $\phi \sub C \ll \omega_m$.
Hence,
%
\begin{align*}
	\sum_m^{\mathclap{|\omega_m| \geq \omega_l}}
    \frac
        {\phi(\I \omega_m)}
        {\sqrt{[\omega_m Z(\I \omega_m)]^2 + \phi^2(\I \omega_m)}}
    \approx \sum_m^{\mathclap{|\omega_m| \geq \omega_l}}
    \frac{\phi \sub C}{|\omega_m|}
\end{align*}
%
where $Z(\I \omega_m) = 1$ has been assumed additionally. It follows that
%
\begin{align*}
	\Big[
        1 + \mu \pi T \sum_m^{\mathclap{\omega_l \leq |\omega_m| < \omega_u}}
        |\omega_m|^{-1}
    \Big]
    \phi \sub C = -\mu \pi T \sum_m^{\mathclap{|\omega_m| < \omega_l}}
    \frac
        {\phi(\I \omega_m)}
        {\sqrt{[\omega_m Z(\I \omega_m)]^2 + \phi^2(\I \omega_m)}}
\end{align*}
%
or equivalently
%
\begin{align*}
	\phi \sub C = -\mu^* \pi T \sum_m^{\mathclap{|\omega_m| < \omega_l}}
    \frac
        {\phi(\I \omega_m)}
        {\sqrt{[\omega_m Z(\I \omega_m)]^2 + \phi^2(\I \omega_m)}}
    \quad \text{with} \quad
    \mu^* &= \frac \mu {1 + \mu \pi T
    \sum_m^{\omega_l \leq |\omega_m| < \omega_u} |\omega_m|^{-1}},
\end{align*}
%
the \emph{\textsc{Anderson-Morel} \textsc{Coulomb} pseudo-potential}. One can
further simplify
%
\begin{align*}
	\pi T \sum_m^{\mathclap{\omega_l \leq |\omega_m| < \omega_u}}
    |\omega_m|^{-1}
    &= \sum_m^{\mathclap{\omega_l \leq |\omega_m| < \omega_u}}
    \frac 1 {|2 m + 1|}
    = \sum_{m = l}^{u - 1} \frac 1 {m + \frac 1 2} \\
	&= \psi(u + \tfrac 1 2) - \psi(l + \tfrac 1 2)
    \approx \log \frac{u + \frac 1 2}{l + \frac 1 2}
    = \log \frac{2 u + 1}{2 l + 1} = \ln \frac{\omega_u}{\omega_l},
\end{align*}
%
where $\psi(x) = \varGamma'(x) / \varGamma(x)$ is the digamma function and the
approximate identity becomes exact asymptotically for large arguments and is
related to the \textsc{Stirling} formula.\footnote{Appendix~A of
\cite{AllenMitrovic82} is dedicated to the digamma function.} Hence,
%
\begin{align*}
	\mu^* = \frac \mu {1 + \mu \ln(\omega_u / \omega_l)}.
\end{align*}

Analogous derivations are given by \name{Schrieffer}
\cite[185-188]{Schrieffer83} and \name{Allen} and \name{Mitrovi\'{c}}
\cite[Sec.~9]{AllenMitrovic82}. According to the former, the formula for $\mu^*$
was first given in 1959 by \name{Bogoliubov}, \name{Tolmachev} and
\name{Shirkov} \cite[83]{BogoliubovTolmachevShirkov59}. Nevertheless, the
quantity is named after Pierre \textsc{Morel} and Philip W. \textsc{Anderson}
with reference to Ref.~\barecite{MorelAnderson62} from 1962.

\subsection{Real-axis equations}

In this section the analytic continuation of the self-energy or the
corresponding \name{Eliashberg} equations, which is complicated by the summation
over \name{Matsubara} frequencies, is performed within the constant-DOS
approximation.

The first step is to withdraw the dependence on \name{Matsubara} frequencies
from the \name{Green} function with the help of a spectral representation. Under
the energy integral,
%
\begin{equation*}
    \int \from{-\infty} \till \infty \D \epsilon \, \vec G_\epsilon(\I \omega_n)
    = -\frac 1 \pi
    \int \from{-\infty} \till \infty \D \omega' \,
    \frac 1 {\I \omega_n - \omega'}
    \Im \int \from{-\infty} \till \infty \D \epsilon \,
    \vec G_\epsilon(\omega'_+),
\end{equation*}
%
where $\omega'_+ = \omega' + \I 0^+$. The \name{Green} function matrix,
analytically continued to arbitrary frequency arguments $\omega$ and dependent
on energy $\epsilon_{\vec k}$ rather than wave number $\vec k$, reads
%
\begin{equation*}
    \vec G_\epsilon(\omega) = \frac
        { \omega Z(\omega) \vec \sigma_0
        + \phi(\omega) \vec \sigma_1
        + \epsilon \vec \sigma_3 }
        { \omega^2 Z^2(\omega)
        - \phi^2(\omega)
        - \epsilon^2}.
\end{equation*}
%
Using Eqs.~\ref{integrals} one finds, in accordance with Eq.~2.19a of
Ref.~\barecite{ScalapinoSchriefferWilkins66},
%
\begin{equation*}
    -\frac 1 \pi \int \from{-\infty} \till \infty \D \epsilon \,
    \vec G_\epsilon(\omega)
    = \frac
        {\omega Z(\omega) \vec \sigma_0 + \phi(\omega) \vec \sigma_1}
        {\sqrt{-\omega^2 Z^2(\omega) + \phi^2(\omega)}}
    = \I \frac
        {\omega Z(\omega) \vec \sigma_0 + \phi(\omega) \vec \sigma_1}
        {\sqrt[\dagger]{\omega^2 Z^2(\omega) - \phi^2(\omega)}}
    = \I \frac
        {\omega \vec \sigma_0 + \Delta(\omega) \vec \sigma_1}
        {\sqrt[*]{\omega^2 - \Delta^2(\omega)}}.
\end{equation*}
%
Let $\varphi$ represent the complex arguments of the above square roots. The
first square root is the principal one defined by $-\frac \pi 2 < \varphi \leq
\frac \pi 2$. Since a multiplication with $\I$ corresponds to a rotation by
$\frac \pi 2$ in the complex plane, the second square root must be taken from
the upper half-plane such that $0 < \varphi \leq \pi$
\cite[Eq.~2.19b]{ScalapinoSchriefferWilkins66}. Clockwise rotation by the
complex argument of $Z(\omega)$ yields the domain of the third square root for
which $-\arg[Z(\omega)] < \varphi \leq \pi - \arg[Z(\omega)]$.

Using $\Im[\I \dots] = \Re[\,\dots]$, the phononic part of the self-energy reads
%
\begin{multline*}
    \vec \Sigma \super{ph.} (\I \omega_n)
    = T \sum_m \int \from{-\infty} \till \infty \D \epsilon \,
    \vec \sigma_3 \, \vec G_\epsilon(\I \omega_m) \, \vec \sigma_3 \,
    \lambda(\I \omega_n - \I \omega_m)
    \\
    = T \int \from{-\infty} \till \infty \D \omega' \, \Re \bigg[ \frac
        {\omega'_+ \vec \sigma_0 - \Delta(\omega'_+) \vec \sigma_1}
        {\sqrt[*]{\omega'^2_+ - \Delta^2(\omega'_+)}}
    \bigg]
    \int \from 0 \till \infty \D \omega'' \, \alpha^2 F(\omega'')
    \sum_m \frac 1 {\I \omega_m - \omega'}
    \frac{2 \omega''}{(\omega_n - \omega_m)^2 + \omega''^2}.
\end{multline*}
%
It is now possible to eliminate the summation over \name{Matsubara} frequencies
\cite[Eqs.~3.40, 3.41]{AllenMitrovic82},
%
\begin{equation*}
    T \sum_m \frac 1 {\I \omega_m - \omega'}
    \frac{2 \omega''}{(\omega_n - \omega_m)^2 + \omega''^2}
    = \frac{f_+(-\omega') + f_-(\omega'')}{\I \omega_n - \omega' - \omega''}
    + \frac{f_+( \omega') + f_-(\omega'')}{\I \omega_n - \omega' + \omega''}
    \equiv \Omega(\I \omega_n, \omega', \omega''),
\end{equation*}
%
and to analytically continue the self-energy, which yields
%
\begin{equation*}
    \vec \Sigma \super{ph.} (\omega) =
    \int \from{-\infty} \till \infty \D \omega' \,
    \Re \bigg[ \frac
        {\omega'_+ \vec \sigma_0 - \Delta(\omega'_+) \vec \sigma_1}
        {\sqrt[*]{\omega'^2_+ - \Delta^2(\omega'_+)}}
    \bigg]
    \int \from 0 \till \infty \D \omega'' \, \alpha^2 F(\omega'') \,
    \Omega(\omega, \omega', \omega'').
\end{equation*}

With the identity \cite[Eq.~12.4]{AllenMitrovic82}
%
\begin{equation*}
    T \sum_m \frac 1 {\I \omega_n - \omega'} = -\frac 1 2 [1 - 2 f_+(\omega')]
\end{equation*}
%
the electronic part of the self-energy is analogously found to be
%
\begin{align*}
    \vec \Sigma \super{el.} (\omega)
    = \mu T \sum_{m} \int \from{-\infty} \till \infty \D \epsilon \,
    \vec G_{\vec q} \super{od.} (\omega)
    = -\frac \mu 2 \int \from{-\infty} \till \infty \D \omega' \,
    \Re \bigg[ \frac
        {\Delta(\omega'_+) \vec \sigma_1}
        {\sqrt[*]{\omega'^2_+ - \Delta^2(\omega'_+)}}
    \bigg] [1 - 2 f_+(\omega')].
\end{align*}

For $\vec \Sigma(\omega) = \vec \Sigma \super{ph.}(\omega) + \vec \Sigma
\super{el.}(\omega)$ the so-called \emph{real-axis Eliashberg equations}, which
are actually defined for the whole complex plane, are found to be
%
\begin{align*}
    Z(\omega) = 1 - \frac 1 \omega
    &\int \from{-\infty} \till \infty \D \omega' \,
    \Re \bigg[
        \frac{\omega'_+}{\sqrt[*]{\omega'^2_+ - \Delta^2(\omega'_+)}}
    \bigg] \int \from 0 \till \infty \D \omega'' \, \alpha^2 F(\omega'') \,
    \Omega(\omega, \omega', \omega''),
    \\
    \Delta(\omega) = -\frac 1 {Z(\omega)}
    &\int \from{-\infty} \till \infty \D \omega' \,
    \Re \bigg[
        \frac{\Delta(\omega'_+)}{\sqrt[*]{\omega'^2_+ - \Delta^2(\omega'_+)}}
    \bigg]
    \bigg \{
        [1 - 2 f_+(\omega')] \, \frac \mu 2
        + \int \from 0 \till \infty \D \omega'' \, \alpha^2 F(\omega'') \,
        \Omega(\omega, \omega', \omega'')
    \bigg \}.
\end{align*}

Let $f(\omega)$ represent any of the functions $\omega^2$, $Z(\omega)$ and
$\phi(\omega)$. They all have in common that they transform into their complex
conjugate if the sign of either the real or imaginary part of their argument
changes \cite[Eq.~A5]{AmbegaokarTewordt64}. Formally,
%
\begin{equation*}
    f(-\omega) = f(\omega) \quad \text{and} \quad f(\omega^*) = f^*(\omega).
\end{equation*}
%
The same applies to functions which are derived by means of the four basic
arithmetical operations, such as $\Delta(\omega) = \phi(\omega) / Z(\omega)$,
$\omega^2 + \Delta^2(\omega)$ or $\omega^2 Z^2(\omega) + \phi^2(\omega)$.
Complex conjugation reflects a number across the real axis and its square roots
across any of the axes which span the complex plane, i.e. from odd- to
even-numbered quadrants or vice versa if the number is not real. As a
consequence, sign changes of $\Im[\omega^2 + \Delta^2(\omega)]$ and
$\Re[\sqrt[*]{\omega^2 + \Delta^2(\omega)}]$ are coupled. Note that the domain
of $\sqrt[*] \cdots$ changes with $Z(\omega)$.

These symmetries are now used to fold the negative half of the range of the
$\omega'$ integral onto the positive one, which yields the final form of the
real-axis \name{Eliashberg} equations:
%
\begin{subequations} \label{real-axis Eliashberg equations}
    \begin{align} \notag
        Z(\omega) = 1 - \frac 1 \omega
        &\int \from 0 \till \infty \D \omega' \,
        \Re \bigg[
            \frac{\omega'_+}{\sqrt[*]{\omega'^2_+ - \Delta^2(\omega'_+)}}
        \bigg]
        \times \dots
        \\ \label{Z(omega)}
        \dots \times
        &\int \from 0 \till \infty \D \omega'' \, \alpha^2 F(\omega'') \,
        [ \Omega(\omega,  \omega', \omega'')
        + \Omega(\omega, -\omega', \omega'') ],
        \\ \notag
        \Delta(\omega) = -\frac 1 {Z(\omega)}
        &\int \from 0 \till \infty \D \omega' \,
        \Re \bigg[ \frac
            {\Delta(\omega'_+)}
            {\sqrt[*]{\omega'^2_+ - \Delta^2(\omega'_+)}}
        \bigg]
        \bigg \{
            [1 - 2 f_+(\omega')] \, \mu
            + \dots
            \\
            \dots +
            &\int \from 0 \till \infty \D \omega'' \, \alpha^2 F(\omega'') \,
            [ \Omega(\omega,  \omega', \omega'')
            - \Omega(\omega, -\omega', \omega'') ]
        \bigg \}.
    \end{align}
\end{subequations}
%
The $\omega$ in the denominator of Eq.~\ref{Z(omega)} is cancelled since, where
braces enclose alternatives,
%
\begin{equation*}
    \frac {
        \Omega(\omega,  \omega', \omega'') \pm
        \Omega(\omega, -\omega', \omega'')
        } 2
    = \begin{Bmatrix} \omega \\ \omega' + \omega'' \end{Bmatrix}
    \frac
        {f_+(-\omega') + f_-(\omega'')}
        {\omega^2 -(\omega' + \omega'')^2}
    + \begin{Bmatrix} \omega \\ \omega' - \omega'' \end{Bmatrix}
    \frac
        {f_+(\omega') + f_-(\omega'')}
        {\omega^2 -(\omega' - \omega'')^2}.
\end{equation*}

\section{\name{McMillan}'s formula}

In 1968, William L. \name{McMillan} established a formula to estimate the
transition temperature $T \sub c$ of the superconducting state from only three
characteristic parameters: an average phonon frequency $\av \omega$, the
electron-phonon coupling strength $\lambda$ and the \name{Coulomb}
pseudo-potential $\mu^*$. This section provides a review of the original work
\cite{McMillan68}.

The starting point is a linearized form of the real-axis \name{Eliashberg}
equations analogous to Eqs.~\ref{linearized Eliashberg equations}. Introducing
two cutoff energies, the maximum phonon frequency $\omega_0$ and the electronic
bandwidth $E \sub B$, Eq.~\ref{real-axis Eliashberg equations} becomes
%
\begin{align*}
    Z(\omega) = 1 - \frac 1 \omega
    \int \from 0 \till \infty \D \omega'
    &\int \from 0 \till{\omega_0} \D \omega'' \, \alpha^2 F(\omega'') \,
    [\Omega(\omega, \omega', \omega'') + \Omega(\omega, -\omega', \omega'')],
    \\
    \Delta(\omega) = -\frac 1 {Z(\omega)}
    \int \from 0 \till \infty \D \omega' \,
    \!&\,\frac{\Re[\Delta(\omega')]}{\omega'}
    \Big \{
        \Theta(E \sub B - \omega') \, [1 - 2 f_+(\omega')] \, \mu
        + \dots
        \\
        \dots +
        &\int \from 0 \till{\omega_0} \D \omega'' \, \alpha^2 F(\omega'') \,
        [\Omega(\omega, \omega', \omega'') - \Omega(\omega, -\omega', \omega'')]
    \Big \}.
\end{align*}

The idea is to find an analytical expression which roughly approximates $T \sub
c$ and can be used to fit numerical results. To that end, a simple trial
function for $\Delta(\omega)$ is introduced, which shall solve the
\name{Eliashberg} equations, i.e. be self-consistent, at least at low and high
frequencies:
%
\begin{equation*}
    \Delta(\omega) = \begin{cases}
        \Delta_0 & \text{for $|\omega| < \omega_0$,} \\
        \Delta_\infty & \text{otherwise,}
    \end{cases}
\end{equation*}
%
where $\Delta_0, \Delta_\infty \in \mathds R$. Several approximate contributions
to $\Delta(0)$ and $\Delta(\infty)$ are taken into account:
%
\begin{enumerate}
    \item \textbf{Phononic contribution to \bm$\Delta(0)$ for \bm$\omega' <
    \omega_0$.} Neglecting $\omega'$ relative to $\omega''$ yields
    %
    \begin{gather*}
        \Omega(0, \omega', \omega'') - \Omega(0, -\omega', \omega'')
        \approx -\frac 2 {\omega''} [1 - 2 f_+(\omega')],
        \\
        \Delta^{(1)}(0) \approx \frac{\Delta_0}{Z(0)}
        \hypo
            {\int_0^{\omega_0} \frac{\D \omega'}{\omega'}
            \hyper{[1 - 2 f_+(\omega')]}{\approx \Theta(\omega' - T \sub c)}}
            {\approx \ln(\omega_0 / T \sub c)} \
        \hypo
            {2 \int_0^{\omega_0} \frac{\D \omega''}{\omega''}
            \alpha^2 F(\omega'')}{\equiv \lambda},
    \end{gather*}
    %
    where the \emph{electron-phonon coupling strength} $\lambda$ has been
    defined.
    %
    \item \textbf{Phononic contribution to \bm$\Delta(0)$ for \bm$\omega' \geq
    \omega_0$.} Neglecting $\omega''$ relative to $\omega'$ yields
    %
    \begin{gather*}
        \Omega(0, \omega', \omega'') - \Omega(0, -\omega', \omega'')
        \approx -\frac 2 {\omega'} [1 + 2 f_-(\omega'')],
        \\
        \Delta^{(2)}(0) \approx \frac{\Delta_\infty \lambda}{Z(0)}
        \hypo
            {\int_{\omega_0}^\infty \frac{\D \omega'}{\omega'^2}}
            {= 1 / \omega_0} \
        \hypo
            {\frac 2 \lambda \int \from 0 \till{\omega_0} \D \omega'' \,
            \alpha^2 F(\omega'')}{\equiv \av \omega}
        \hypo{[1 + 2 f_-(\omega'')]}{\approx 1},
    \end{gather*}
    %
    where an \emph{average phonon frequency} $\av \omega$ has been defined.
    %
    \item \textbf{Phononic contribution to \bm$\Delta(\infty)$.} This part
    vanishes for $\Omega(\infty, \omega', \omega'') - \Omega(\infty, -\omega',
    \omega'') = 0$.
    %
    \item \textbf{Electronic contribution to \bm$\Delta(0)$.} Approximating the
    distributions as in $\Delta^{(1)}(0)$ and $\Delta^{(2)}(0)$,
    %
    \begin{equation*}
        \Delta^{(3)}(0) = -\frac \mu {Z(0)} \bigg[
            \Delta_0 \hypo
                {\int_0^{\omega_0} \frac{\D \omega'}{\omega'}
                \hyper
                    {[1 - 2 f_+(\omega')]}
                    {\approx \Theta(\omega' - T \sub c)}}
                {\approx \ln(\omega_0 / T \sub c)}
            + \Delta_\infty \hypo
                {\int_{\omega_0}^{E \sub B}
                \frac{\D \omega'}{\omega'}}{= \ln(E \sub B / \omega_0)}
            \hypo{[1 - 2 f_+(\omega')]}{\approx 1}
        \bigg].
    \end{equation*}
    %
    \item \textbf{Electronic contribution to \bm$\Delta(\infty)$.} Analogous to
    the calculation of $\Delta^{(3)}(0)$,
    %
    \begin{equation*}
        \Delta(\infty) \approx -\frac \mu {Z(\infty)} \bigg[
            \Delta_0 \ln \frac{\omega_0}{T \sub c}
            + \Delta_\infty \ln \frac{E \sub B}{\omega_0}
        \bigg].
    \end{equation*}
\end{enumerate}

\section{Computational implementation}
