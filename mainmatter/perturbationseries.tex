%!TEX root = ../thesis.tex

\chapter{Perturbation series}

\usetikzlibrary{decorations.markings}

\pgfdeclaredecoration{waves}{start}{
    \state{start}[width=0pt, next state=positive, persistent precomputation={
        \pgfmathsetlengthmacro\pgfdecorationsegmentlength{
            \pgfdecoratedinputsegmentlength / int(2
                * \pgfdecoratedinputsegmentlength
                / \pgfdecorationsegmentlength
                )
            }
        }] \relax
    \state{positive}[width=\pgfdecorationsegmentlength, next state=negative]{
        \pgfpathsine{\pgfpoint
            {\pgfdecorationsegmentlength/2}
            {\pgfdecorationsegmentamplitude/2}
            }
        \pgfpathcosine{\pgfpoint
            {\pgfdecorationsegmentlength/2}
            {\pgfdecorationsegmentamplitude/-2}
            }
        }
    \state{negative}[width=\pgfdecorationsegmentlength, next state=positive]{
        \pgfpathsine{\pgfpoint
            {\pgfdecorationsegmentlength/2}
            {\pgfdecorationsegmentamplitude/-2}
            }
        \pgfpathcosine{\pgfpoint
            {\pgfdecorationsegmentlength/2}
            {\pgfdecorationsegmentamplitude/2}
            }
        }
    \state{final}{\pgfpathmoveto\pgfpointdecoratedpathlast}
    }

\tikzset{electron/.style={
    thick,
    decoration={markings, mark=at position 0.5 with {\arrow>}},
    postaction={decorate},
    }}

\tikzset{phonon/.style={
    thick,
    decoration={waves, amplitude=2mm/3, segment length=2mm},
    decorate,
    }}

\begin{figure}
    \small
    \medmuskip=0mu
    \begin{subfigure}[b]{\linewidth/3}
        \centering
        \tikzsetnextfilename{hartree}
        \input{tikzin/hartree.tex}
        \caption{Hartree}
    \end{subfigure}%
    \begin{subfigure}[b]{\linewidth/3}
        \centering
        \tikzsetnextfilename{fock}
        \input{tikzin/fock.tex}
        \caption{Fock}
    \end{subfigure}%
    \begin{subfigure}[b]{\linewidth/3}
        \centering
        \tikzsetnextfilename{fock-anomalous}
        \input{tikzin/fock-anomalous.tex}
        \caption{Fock, anomalous}
    \end{subfigure}\\[1cm]
    \begin{subfigure}[b]{\linewidth/3}
        \centering
        \tikzsetnextfilename{glasses}
        \input{tikzin/glasses.tex}
        \caption{``Glasses''}
    \end{subfigure}%
    \begin{subfigure}[b]{\linewidth/3}
        \centering
        \tikzsetnextfilename{porthole}
        \input{tikzin/porthole.tex}
        \caption{``Porthole''}
    \end{subfigure}%
    \begin{subfigure}[b]{\linewidth/3}
        \centering
        \tikzsetnextfilename{porthole-anomalous}
        \input{tikzin/porthole-anomalous.tex}
        \caption{``Porthole'', anomalous}
    \end{subfigure}
    \caption{2nd order \name{Feynman} graphs}
\end{figure}
